"0","set.seed(1912)"
"0",""
"0","#Defining parameters "
"0","n <- 30 #set to 50?"
"0","mu_asd <- log(1.5)"
"0","sigma_asd <- log(1.5)-log(1.5-0.5)"
"0","mu_td <- log(1.5)"
"0","sigma_td <- log(1.5)-log(1.5-0.3)"
"0",""
"0","mu_visit_asd <- 0.15  "
"0","sigma_visit_asd <-  0.1 "
"0",""
"0","mu_visit_td <-  0.20 "
"0","sigma_visit_td <- 0.08  "
"0",""
"0","visit <- 6"
"0","error <- 0.2"
"0",""
"0","#Making a function for simulating data"
"0","s_d <- function(n, visit, mu_asd, mu_td, sigma_asd, sigma_td, error){"
"0","  s_df <- tibble(expand.grid(ID=seq(n),"
"0","                             Diag= c(""ASD"", ""TD""),"
"0","                             Visit = seq(visit))) %>%  "
"0","    mutate(ID = ifelse(Diag == ""TD"", ID + (n*2), ID), "
"0","           IndividualIntercept = NA, "
"0","           IndividualSlope = NA, "
"0","           MLU = NA)"
"0","  "
"0","  for (i in seq(s_df$ID)) {"
"0","    #Assigning individual intercept"
"0","    s_df$IndividualIntercept[s_df$ID == i & s_df$Diag == ""ASD""] <- rnorm(1, mu_asd, sigma_asd)"
"0","    s_df$IndividualIntercept[s_df$ID == i & s_df$Diag == ""TD""] <- rnorm(1, mu_td, sigma_td)"
"0","    "
"0","    #Assigning individual slope"
"0","    s_df$IndividualSlope[s_df$ID == i & s_df$Diag == ""ASD""] <- rnorm(1, mu_visit_asd, sigma_visit_asd)"
"0","    s_df$IndividualSlope[s_df$ID == i & s_df$Diag == ""TD""] <- rnorm(1, mu_visit_td, sigma_visit_td)"
"0","  }"
"0","  "
"0","  for (i in seq(nrow(s_df))){"
"0","  s_df$MLU[i] <- exp(rnorm(1, (s_df$IndividualIntercept[i] + s_df$IndividualSlope[i] * (s_df$Visit[i]-1)), error))"
"0","                  }"
"0","  "
"0","  "
"0","  "
"0","  return(s_df)"
"0","}"
"0",""
"0","d <- s_d(n, visit, mu_asd, mu_td, sigma_asd, sigma_td, error)"
"0",""
"0","#Visualizing data"
"0","ggplot(d, aes(Visit, MLU, color = Diag, group = ID)) + "
"0","  theme_bw() + "
"0","  geom_point() + "
"0","  geom_line(alpha = 0.3)"
"0",""
